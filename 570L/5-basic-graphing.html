<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>A Sufficient Introduction to R</title>
  <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
  <meta name="description" content="These notes serve as an introduction to R, but certainly is not comprehensive. The intention is to teach students enought to be able to work with data frames and make graphs using ggplot2. I also cover a range of common data issues that PhD students often have to address.">
  <meta name="generator" content="bookdown 0.1.5 and GitBook 2.6.7">

  <meta property="og:title" content="A Sufficient Introduction to R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="These notes serve as an introduction to R, but certainly is not comprehensive. The intention is to teach students enought to be able to work with data frames and make graphs using ggplot2. I also cover a range of common data issues that PhD students often have to address." />
  <meta name="github-repo" content="dereksonderegger/STA_570L_Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Sufficient Introduction to R" />
  
  <meta name="twitter:description" content="These notes serve as an introduction to R, but certainly is not comprehensive. The intention is to teach students enought to be able to work with data frames and make graphs using ggplot2. I also cover a range of common data issues that PhD students often have to address." />
  

<meta name="author" content="Derek L. Sonderegger">

<meta name="date" content="2016-10-12">

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } }
});
</script>

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="4-data-types.html">
<link rel="next" href="6-matrices-data-frames-and-lists.html">

<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>


  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Sufficient Introduction to R</a></li>
<li><a href="https://dereksonderegger.github.io/570L/A_Sufficient_Introduction_to_R.pdf" target="blank">PDF version</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#r-as-a-simple-calculator"><i class="fa fa-check"></i><b>1.1</b> R as a simple calculator</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#assignment"><i class="fa fa-check"></i><b>1.2</b> Assignment</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#scripts-and-rmarkdown"><i class="fa fa-check"></i><b>1.3</b> Scripts and RMarkdown</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#r-scripts-.r-files"><i class="fa fa-check"></i><b>1.3.1</b> R Scripts (.R files)</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#r-markdown-.rmd-files"><i class="fa fa-check"></i><b>1.3.2</b> R Markdown (.Rmd files)</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#packages"><i class="fa fa-check"></i><b>1.4</b> Packages</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#exercises"><i class="fa fa-check"></i><b>1.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-vectors.html"><a href="2-vectors.html"><i class="fa fa-check"></i><b>2</b> Vectors</a><ul>
<li class="chapter" data-level="2.1" data-path="2-vectors.html"><a href="2-vectors.html#accessing-vector-elements"><i class="fa fa-check"></i><b>2.1</b> Accessing Vector Elements</a></li>
<li class="chapter" data-level="2.2" data-path="2-vectors.html"><a href="2-vectors.html#scalar-functions-applied-to-vectors"><i class="fa fa-check"></i><b>2.2</b> Scalar Functions Applied to Vectors</a></li>
<li class="chapter" data-level="2.3" data-path="2-vectors.html"><a href="2-vectors.html#vector-algebra"><i class="fa fa-check"></i><b>2.3</b> Vector Algebra</a></li>
<li class="chapter" data-level="2.4" data-path="2-vectors.html"><a href="2-vectors.html#commonly-used-vector-functions"><i class="fa fa-check"></i><b>2.4</b> Commonly Used Vector Functions</a></li>
<li class="chapter" data-level="2.5" data-path="2-vectors.html"><a href="2-vectors.html#exercises-1"><i class="fa fa-check"></i><b>2.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html"><i class="fa fa-check"></i><b>3</b> Statistical Tables</a><ul>
<li class="chapter" data-level="3.1" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html#mosaicplotdist-function"><i class="fa fa-check"></i><b>3.1</b> <code>mosaic::plotDist()</code> function</a></li>
<li class="chapter" data-level="3.2" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html#base-r-functions"><i class="fa fa-check"></i><b>3.2</b> Base R functions</a><ul>
<li class="chapter" data-level="3.2.1" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html#d-function"><i class="fa fa-check"></i><b>3.2.1</b> d-function</a></li>
<li class="chapter" data-level="3.2.2" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html#p-function"><i class="fa fa-check"></i><b>3.2.2</b> p-function</a></li>
<li class="chapter" data-level="3.2.3" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html#q-function"><i class="fa fa-check"></i><b>3.2.3</b> <code>q</code>-function</a></li>
<li class="chapter" data-level="3.2.4" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html#r-function"><i class="fa fa-check"></i><b>3.2.4</b> r-function</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="3-statistical-tables.html"><a href="3-statistical-tables.html#exercises-2"><i class="fa fa-check"></i><b>3.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-data-types.html"><a href="4-data-types.html"><i class="fa fa-check"></i><b>4</b> Data Types</a><ul>
<li class="chapter" data-level="4.1" data-path="4-data-types.html"><a href="4-data-types.html#integers-and-numerics"><i class="fa fa-check"></i><b>4.1</b> Integers and Numerics</a></li>
<li class="chapter" data-level="4.2" data-path="4-data-types.html"><a href="4-data-types.html#character-strings"><i class="fa fa-check"></i><b>4.2</b> Character Strings</a></li>
<li class="chapter" data-level="4.3" data-path="4-data-types.html"><a href="4-data-types.html#factors"><i class="fa fa-check"></i><b>4.3</b> Factors</a></li>
<li class="chapter" data-level="4.4" data-path="4-data-types.html"><a href="4-data-types.html#logicals"><i class="fa fa-check"></i><b>4.4</b> Logicals</a></li>
<li class="chapter" data-level="4.5" data-path="4-data-types.html"><a href="4-data-types.html#exercises-3"><i class="fa fa-check"></i><b>4.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html"><i class="fa fa-check"></i><b>5</b> Basic Graphing</a><ul>
<li class="chapter" data-level="5.1" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#univariate-graphs"><i class="fa fa-check"></i><b>5.1</b> Univariate Graphs</a><ul>
<li class="chapter" data-level="5.1.1" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#histograms"><i class="fa fa-check"></i><b>5.1.1</b> Histograms</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#bivariate-plots"><i class="fa fa-check"></i><b>5.2</b> Bivariate Plots</a><ul>
<li class="chapter" data-level="5.2.1" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#boxplots"><i class="fa fa-check"></i><b>5.2.1</b> Boxplots</a></li>
<li class="chapter" data-level="5.2.2" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#scatterplots"><i class="fa fa-check"></i><b>5.2.2</b> Scatterplots</a></li>
<li class="chapter" data-level="5.2.3" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#arbitrary-curves"><i class="fa fa-check"></i><b>5.2.3</b> Arbitrary Curves</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#advanced-tricks"><i class="fa fa-check"></i><b>5.3</b> Advanced tricks</a><ul>
<li class="chapter" data-level="5.3.1" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#blank-plots"><i class="fa fa-check"></i><b>5.3.1</b> Blank plots</a></li>
<li class="chapter" data-level="5.3.2" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#points"><i class="fa fa-check"></i><b>5.3.2</b> Points</a></li>
<li class="chapter" data-level="5.3.3" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#lines"><i class="fa fa-check"></i><b>5.3.3</b> Lines</a></li>
<li class="chapter" data-level="5.3.4" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#contour-plots"><i class="fa fa-check"></i><b>5.3.4</b> Contour Plots</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="5-basic-graphing.html"><a href="5-basic-graphing.html#exercises-4"><i class="fa fa-check"></i><b>5.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-matrices-data-frames-and-lists.html"><a href="6-matrices-data-frames-and-lists.html"><i class="fa fa-check"></i><b>6</b> Matrices, Data Frames, and Lists</a><ul>
<li class="chapter" data-level="6.1" data-path="6-matrices-data-frames-and-lists.html"><a href="6-matrices-data-frames-and-lists.html#matrices"><i class="fa fa-check"></i><b>6.1</b> Matrices</a></li>
<li class="chapter" data-level="6.2" data-path="6-matrices-data-frames-and-lists.html"><a href="6-matrices-data-frames-and-lists.html#data-frames"><i class="fa fa-check"></i><b>6.2</b> Data Frames</a></li>
<li class="chapter" data-level="6.3" data-path="6-matrices-data-frames-and-lists.html"><a href="6-matrices-data-frames-and-lists.html#lists"><i class="fa fa-check"></i><b>6.3</b> Lists</a></li>
<li class="chapter" data-level="6.4" data-path="6-matrices-data-frames-and-lists.html"><a href="6-matrices-data-frames-and-lists.html#exercises-5"><i class="fa fa-check"></i><b>6.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-importing-data.html"><a href="7-importing-data.html"><i class="fa fa-check"></i><b>7</b> Importing Data</a><ul>
<li class="chapter" data-level="7.1" data-path="7-importing-data.html"><a href="7-importing-data.html#working-directory"><i class="fa fa-check"></i><b>7.1</b> Working directory</a></li>
<li class="chapter" data-level="7.2" data-path="7-importing-data.html"><a href="7-importing-data.html#comma-separated-data"><i class="fa fa-check"></i><b>7.2</b> Comma Separated Data</a></li>
<li class="chapter" data-level="7.3" data-path="7-importing-data.html"><a href="7-importing-data.html#ms-excel"><i class="fa fa-check"></i><b>7.3</b> MS Excel</a><ul>
<li class="chapter" data-level="7.3.1" data-path="7-importing-data.html"><a href="7-importing-data.html#libxls-bug"><i class="fa fa-check"></i><b>7.3.1</b> <code>libxls</code> bug</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="7-importing-data.html"><a href="7-importing-data.html#exercises-6"><i class="fa fa-check"></i><b>7.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html"><i class="fa fa-check"></i><b>8</b> Data Manipulation</a><ul>
<li class="chapter" data-level="8.1" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#classical-functions-for-summarizing-rows-and-columns"><i class="fa fa-check"></i><b>8.1</b> Classical functions for summarizing rows and columns</a><ul>
<li class="chapter" data-level="8.1.1" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#summary"><i class="fa fa-check"></i><b>8.1.1</b> <code>summary()</code></a></li>
<li class="chapter" data-level="8.1.2" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#apply"><i class="fa fa-check"></i><b>8.1.2</b> <code>apply()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#package-dplyr"><i class="fa fa-check"></i><b>8.2</b> Package <code>dplyr</code></a><ul>
<li class="chapter" data-level="8.2.1" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#verbs"><i class="fa fa-check"></i><b>8.2.1</b> Verbs</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#split-apply-combine"><i class="fa fa-check"></i><b>8.2.2</b> Split, apply, combine</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#chaining-commands-together"><i class="fa fa-check"></i><b>8.2.3</b> Chaining commands together</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-data-manipulation.html"><a href="8-data-manipulation.html#exercises-7"><i class="fa fa-check"></i><b>8.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-data-reshaping.html"><a href="9-data-reshaping.html"><i class="fa fa-check"></i><b>9</b> Data Reshaping</a><ul>
<li class="chapter" data-level="9.1" data-path="9-data-reshaping.html"><a href="9-data-reshaping.html#tidyr"><i class="fa fa-check"></i><b>9.1</b> <code>tidyr</code></a><ul>
<li class="chapter" data-level="9.1.1" data-path="9-data-reshaping.html"><a href="9-data-reshaping.html#verbs-1"><i class="fa fa-check"></i><b>9.1.1</b> Verbs</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="9-data-reshaping.html"><a href="9-data-reshaping.html#exercises-8"><i class="fa fa-check"></i><b>9.2</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html"><i class="fa fa-check"></i><b>10</b> Graphing using <code>ggplot2</code></a><ul>
<li class="chapter" data-level="10.1" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#basic-graphs"><i class="fa fa-check"></i><b>10.1</b> Basic Graphs</a><ul>
<li class="chapter" data-level="10.1.1" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#scatterplots-1"><i class="fa fa-check"></i><b>10.1.1</b> Scatterplots</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#bar-charts"><i class="fa fa-check"></i><b>10.1.2</b> Bar Charts</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#box-plots"><i class="fa fa-check"></i><b>10.1.3</b> Box Plots</a></li>
<li class="chapter" data-level="10.1.4" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#geometries-and-layers"><i class="fa fa-check"></i><b>10.1.4</b> Geometries and Layers</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#getting-fancy"><i class="fa fa-check"></i><b>10.2</b> Getting Fancy</a><ul>
<li class="chapter" data-level="10.2.1" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#bar-plot"><i class="fa fa-check"></i><b>10.2.1</b> Bar Plot</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#histograms-1"><i class="fa fa-check"></i><b>10.2.2</b> Histograms</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#adjusting-labels"><i class="fa fa-check"></i><b>10.2.3</b> Adjusting labels</a></li>
<li class="chapter" data-level="10.2.4" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#plotting-distributions"><i class="fa fa-check"></i><b>10.2.4</b> Plotting distributions</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-graphing-using-ggplot2.html"><a href="10-graphing-using-ggplot2.html#exercises-9"><i class="fa fa-check"></i><b>10.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html"><i class="fa fa-check"></i><b>11</b> More <code>ggplot2</code></a><ul>
<li class="chapter" data-level="11.1" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html#faceting"><i class="fa fa-check"></i><b>11.1</b> Faceting</a></li>
<li class="chapter" data-level="11.2" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html#modifying-scales"><i class="fa fa-check"></i><b>11.2</b> Modifying Scales</a><ul>
<li class="chapter" data-level="11.2.1" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html#log-scales"><i class="fa fa-check"></i><b>11.2.1</b> Log scales</a></li>
<li class="chapter" data-level="11.2.2" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html#arbitrary-transformations"><i class="fa fa-check"></i><b>11.2.2</b> Arbitrary transformations</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html#multi-plot"><i class="fa fa-check"></i><b>11.3</b> Multi-plot</a></li>
<li class="chapter" data-level="11.4" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html#themes"><i class="fa fa-check"></i><b>11.4</b> Themes</a></li>
<li class="chapter" data-level="11.5" data-path="11-more-ggplot2.html"><a href="11-more-ggplot2.html#exercises-10"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="12-flow-control.html"><a href="12-flow-control.html"><i class="fa fa-check"></i><b>12</b> Flow Control</a><ul>
<li class="chapter" data-level="12.1" data-path="12-flow-control.html"><a href="12-flow-control.html#decision-statements"><i class="fa fa-check"></i><b>12.1</b> Decision statements</a></li>
<li class="chapter" data-level="12.2" data-path="12-flow-control.html"><a href="12-flow-control.html#loops"><i class="fa fa-check"></i><b>12.2</b> Loops</a><ul>
<li class="chapter" data-level="12.2.1" data-path="12-flow-control.html"><a href="12-flow-control.html#while-loops"><i class="fa fa-check"></i><b>12.2.1</b> <code>while</code> Loops</a></li>
<li class="chapter" data-level="12.2.2" data-path="12-flow-control.html"><a href="12-flow-control.html#for-loops"><i class="fa fa-check"></i><b>12.2.2</b> <code>for</code> Loops</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="12-flow-control.html"><a href="12-flow-control.html#exercises-11"><i class="fa fa-check"></i><b>12.3</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="13-user-defined-functions.html"><a href="13-user-defined-functions.html"><i class="fa fa-check"></i><b>13</b> User Defined Functions</a><ul>
<li class="chapter" data-level="13.1" data-path="13-user-defined-functions.html"><a href="13-user-defined-functions.html#basic-function-definition"><i class="fa fa-check"></i><b>13.1</b> Basic function definition</a></li>
<li class="chapter" data-level="13.2" data-path="13-user-defined-functions.html"><a href="13-user-defined-functions.html#parameter-defaults"><i class="fa fa-check"></i><b>13.2</b> Parameter Defaults</a></li>
<li class="chapter" data-level="13.3" data-path="13-user-defined-functions.html"><a href="13-user-defined-functions.html#ellipses"><i class="fa fa-check"></i><b>13.3</b> Ellipses</a></li>
<li class="chapter" data-level="13.4" data-path="13-user-defined-functions.html"><a href="13-user-defined-functions.html#function-overloading"><i class="fa fa-check"></i><b>13.4</b> Function Overloading</a></li>
<li class="chapter" data-level="13.5" data-path="13-user-defined-functions.html"><a href="13-user-defined-functions.html#scope"><i class="fa fa-check"></i><b>13.5</b> Scope</a></li>
<li class="chapter" data-level="13.6" data-path="13-user-defined-functions.html"><a href="13-user-defined-functions.html#exercises-12"><i class="fa fa-check"></i><b>13.6</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html"><i class="fa fa-check"></i><b>14</b> String Manipulation</a><ul>
<li class="chapter" data-level="14.1" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#base-function"><i class="fa fa-check"></i><b>14.1</b> Base function</a></li>
<li class="chapter" data-level="14.2" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#package-stringr-basic-operations"><i class="fa fa-check"></i><b>14.2</b> Package <code>stringr</code>: basic operations</a><ul>
<li class="chapter" data-level="14.2.1" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#concatenating-with-str_c-or-str_join"><i class="fa fa-check"></i><b>14.2.1</b> Concatenating with <code>str_c()</code> or <code>str_join()</code></a></li>
<li class="chapter" data-level="14.2.2" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#calculating-string-length-with-str_length"><i class="fa fa-check"></i><b>14.2.2</b> Calculating string length with <code>str_length()</code></a></li>
<li class="chapter" data-level="14.2.3" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#extracting-substrings-with-str_sub"><i class="fa fa-check"></i><b>14.2.3</b> Extracting substrings with <code>str_sub()</code></a></li>
<li class="chapter" data-level="14.2.4" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#pad-a-string-with-str_pad"><i class="fa fa-check"></i><b>14.2.4</b> Pad a string with <code>str_pad()</code></a></li>
<li class="chapter" data-level="14.2.5" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#trim-a-string-with-str_trim"><i class="fa fa-check"></i><b>14.2.5</b> Trim a string with <code>str_trim()</code></a></li>
</ul></li>
<li class="chapter" data-level="14.3" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#package-stringr-pattern-matching"><i class="fa fa-check"></i><b>14.3</b> Package <code>stringr</code>: Pattern Matching</a><ul>
<li class="chapter" data-level="14.3.1" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#detecting-a-pattern-using-str_detect"><i class="fa fa-check"></i><b>14.3.1</b> Detecting a pattern using str_detect()</a></li>
<li class="chapter" data-level="14.3.2" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#locating-a-pattern-using-str_locate"><i class="fa fa-check"></i><b>14.3.2</b> Locating a pattern using str_locate()</a></li>
<li class="chapter" data-level="14.3.3" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#replacing-substrings-using-str_replace"><i class="fa fa-check"></i><b>14.3.3</b> Replacing substrings using <code>str_replace()</code></a></li>
<li class="chapter" data-level="14.3.4" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#splitting-into-substrings-using-str_split"><i class="fa fa-check"></i><b>14.3.4</b> Splitting into substrings using <code>str_split()</code></a></li>
</ul></li>
<li class="chapter" data-level="14.4" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#regular-expressions"><i class="fa fa-check"></i><b>14.4</b> Regular Expressions</a></li>
<li class="chapter" data-level="14.5" data-path="14-string-manipulation.html"><a href="14-string-manipulation.html#exercises-13"><i class="fa fa-check"></i><b>14.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="15-dates-and-times.html"><a href="15-dates-and-times.html"><i class="fa fa-check"></i><b>15</b> Dates and Times</a><ul>
<li class="chapter" data-level="15.1" data-path="15-dates-and-times.html"><a href="15-dates-and-times.html#creating-date-and-time-objects"><i class="fa fa-check"></i><b>15.1</b> Creating Date and Time objects</a></li>
<li class="chapter" data-level="15.2" data-path="15-dates-and-times.html"><a href="15-dates-and-times.html#extracting-information"><i class="fa fa-check"></i><b>15.2</b> Extracting information</a></li>
<li class="chapter" data-level="15.3" data-path="15-dates-and-times.html"><a href="15-dates-and-times.html#arithmetic-on-dates"><i class="fa fa-check"></i><b>15.3</b> Arithmetic on Dates</a></li>
<li class="chapter" data-level="15.4" data-path="15-dates-and-times.html"><a href="15-dates-and-times.html#exercises-14"><i class="fa fa-check"></i><b>15.4</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html"><i class="fa fa-check"></i><b>16</b> Rmarkdown Tricks</a><ul>
<li class="chapter" data-level="16.1" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#mathematical-expressions"><i class="fa fa-check"></i><b>16.1</b> Mathematical expressions</a></li>
<li class="chapter" data-level="16.2" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#tables"><i class="fa fa-check"></i><b>16.2</b> Tables</a><ul>
<li class="chapter" data-level="16.2.1" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#simple-tables"><i class="fa fa-check"></i><b>16.2.1</b> Simple Tables</a></li>
<li class="chapter" data-level="16.2.2" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#grid-tables"><i class="fa fa-check"></i><b>16.2.2</b> Grid Tables</a></li>
<li class="chapter" data-level="16.2.3" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#pipe-tables"><i class="fa fa-check"></i><b>16.2.3</b> Pipe Tables</a></li>
</ul></li>
<li class="chapter" data-level="16.3" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#r-functions-to-produce-table-code."><i class="fa fa-check"></i><b>16.3</b> R functions to produce table code.</a><ul>
<li class="chapter" data-level="16.3.1" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#knitrkable"><i class="fa fa-check"></i><b>16.3.1</b> <code>knitr::kable</code></a></li>
<li class="chapter" data-level="16.3.2" data-path="16-rmarkdown-tricks.html"><a href="16-rmarkdown-tricks.html#package-pander"><i class="fa fa-check"></i><b>16.3.2</b> Package <code>pander</code></a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Sufficient Introduction to R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="basic-graphing" class="section level1">
<h1><span class="header-section-number">Chapter 5</span> Basic Graphing</h1>
<p>One of the most important things we can do in exploratory statistics is to just look at the data in graphical form so that we can more easily see trends. Most of the graph functions have similar options for setting the main title, x-label, y-labels, etc.</p>
<div id="univariate-graphs" class="section level2">
<h2><span class="header-section-number">5.1</span> Univariate Graphs</h2>
<p>6.1.1 Barcharts</p>
<p>This is chart that is intended to show the relative differences between a number of groups. To create this graph, all we need is the heights of the individual bars.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">4</span>     <span class="co"># The vector 1,2,3,4</span>
<span class="kw">barplot</span>(x)   <span class="co"># First bar has height 1, next is 2, etc</span></code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<p>This is extremely basic, but is a bit ugly. We’ll add a x and y labels and names for each bar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">4</span>
<span class="kw">barplot</span>(x, 
        <span class="dt">xlab=</span><span class="st">&#39;My X label&#39;</span>, 
        <span class="dt">ylab=</span><span class="st">&#39;My Y Label&#39;</span>, 
        <span class="dt">main=</span><span class="st">&#39;Main Title&#39;</span>, 
          <span class="dt">names.arg=</span><span class="kw">c</span>(<span class="st">&#39;Coho&#39;</span>,<span class="st">&#39;Chinook&#39;</span>,<span class="st">&#39;Pink&#39;</span>,<span class="st">&#39;Sockeye&#39;</span>)
        )</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<div id="histograms" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Histograms</h3>
<p>Histograms are way of summarizing a large number of observations. It allows the reader to see what values are very common and along with the range of the data. The primary aspects of this plot that you might want to change are the number of histogram bins and where the breaks between bins occurs.</p>
<p>To generate data for the histogram, we’ll use the function <code>rnorm(n, mean=0, sd=1)</code> which generates n random variables from a normal distribution with mean <code>mean</code> and standard deviation <code>sd</code>. Notice that rnorm will default to giving random variables from a standard normal distribution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>)
<span class="kw">hist</span>(data)</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>R does a decent job of picking reasonable defaults for the number of bins and breakpoints, but with <span class="math inline">\(10,000\)</span> observations, I think we should have more bins. To do this, I’ll use the optional breaks argument to specify where to split the bins.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(data, <span class="dt">breaks=</span><span class="dv">30</span>)</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
<p>Finally I might want the y-axis to not be the number of observations within a bin, but rather the density of an observation. Density is calculated by taking the number of observations in a bin and then dividing by the total number of observations and then dividing by width of the bin. This forces the sum of the area in all of the bins to be 1. To do this, we’ll use the freq argument and set it to be FALSE.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">hist</span>(data, <span class="dt">breaks=</span><span class="dv">30</span>, <span class="dt">freq=</span><span class="ot">FALSE</span>, <span class="dt">xlab=</span><span class="st">&#39;x&#39;</span>, 
     <span class="dt">main=</span><span class="st">&#39;Histogram of the Standard Normal Distribution&#39;</span> )</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-68-1.png" width="672" /></p>
</div>
</div>
<div id="bivariate-plots" class="section level2">
<h2><span class="header-section-number">5.2</span> Bivariate Plots</h2>
<div id="boxplots" class="section level3">
<h3><span class="header-section-number">5.2.1</span> Boxplots</h3>
<p>Boxplots are designed to compare distributions among multiple groups.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">y &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">mean=</span><span class="dv">1</span>),    <span class="co"># Group A is centered at 1</span>
        <span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">mean=</span>-<span class="dv">1</span>),   <span class="co"># Group B is centered at -1</span>
        <span class="kw">rnorm</span>(<span class="dv">50</span>, <span class="dt">mean=</span><span class="dv">0</span>))    <span class="co"># Group C is centered at 0</span>
group &lt;-<span class="st"> </span><span class="kw">c</span>( <span class="kw">rep</span>(<span class="st">&#39;A&#39;</span>, <span class="dv">50</span>), <span class="kw">rep</span>(<span class="st">&#39;B&#39;</span>,<span class="dv">50</span>), <span class="kw">rep</span>(<span class="st">&#39;C&#39;</span>,<span class="dv">50</span>) )
<span class="kw">boxplot</span>(y ~<span class="st"> </span>group)</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
<p>When calling boxplot() the main argument is a formula that describes a relationship between two variables. Formulas in R are always in the format <code>y.variable ~ x.variable</code> where I think of this as saying my y-variable is a function of the x-variable.</p>
<p>You can get the boxplot to separate on more than one variable by using <code>y.variable ~ x1.variable + x2.variable</code>.</p>
</div>
<div id="scatterplots" class="section level3">
<h3><span class="header-section-number">5.2.2</span> Scatterplots</h3>
<p>Scatterplots are a way to explore the relationship between two continuous variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span><span class="dv">1</span>)
y &lt;-<span class="st"> </span><span class="dv">2</span> +<span class="st"> </span><span class="dv">3</span>*x +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">sd=</span><span class="dv">4</span>)</code></pre></div>
<pre><code>## Warning in 2 + 3 * x + rnorm(10, sd = 4): longer object length is not a
## multiple of shorter object length</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x, y)</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
</div>
<div id="arbitrary-curves" class="section level3">
<h3><span class="header-section-number">5.2.3</span> Arbitrary Curves</h3>
<p>Often I want to plot a curve. To do that, I’ll make a scatterplot, but tell R that I don’t want points, but rather I want it to connect the dots into a curve. To do this I will change the type argument to plot and tell it to make a line.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dt">by=</span>.<span class="dv">01</span>)
<span class="kw">plot</span>(x, <span class="kw">sin</span>(x), <span class="dt">type=</span><span class="st">&#39;l&#39;</span>)</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
</div>
</div>
<div id="advanced-tricks" class="section level2">
<h2><span class="header-section-number">5.3</span> Advanced tricks</h2>
<p>R has a very powerful graphing system that is highly customizable. When a standard plot isn’t sufficient for my needs I will either start with a blank plot or just a piece of a plot and then add elements as necessary.</p>
<p>All of the graphical parameters that can be modified are available in <code>par()</code> and the help page for par is useful for finding out what things you can modify.</p>
<div id="blank-plots" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Blank plots</h3>
<p>The plot function has an argument type that defines the behavior of the scatter plot. The default is to plot points, but another option we have used is to connect the points by lines.</p>
<table>
<thead>
<tr class="header">
<th><code>type</code></th>
<th>Result</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>p</code></td>
<td>Points</td>
</tr>
<tr class="even">
<td><code>l</code></td>
<td>Line (connect the dots)</td>
</tr>
<tr class="odd">
<td><code>b</code></td>
<td>Both points and lines</td>
</tr>
<tr class="even">
<td><code>n</code></td>
<td>None (set up the plot box, but don’t graph anything)</td>
</tr>
</tbody>
</table>
<p>Another useful option to plot is the arguments xlim and ylim which take vectors that define the extent of the two axes.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">type=</span><span class="st">&#39;n&#39;</span>, 
    <span class="dt">xlab=</span><span class="st">&#39;X Label&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Y Label&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Main Title&#39;</span>)</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
</div>
<div id="points" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Points</h3>
<p>Adding points to a graph is done by the function <code>points(x, y)</code> which takes arguments x and y which are numerical vectors of equal length. Arguments that affect the display of points are given below.</p>
<ul>
<li><p><code>pch</code> - point character. This can either be a single character or an integer code for one of a set of graphics symbols. Unfortunately the integer codes start at 19. For a description of which code maps to what character, see the help documention <code>?points</code>.</p></li>
<li><p><code>col</code> - Color of point. This can be a character string or an integer code. The default is black which is also #1. #2 is red and #3 is green.</p></li>
<li><p><code>lwd</code> - Line width for drawing the symbols</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="dt">x=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="dt">y=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="co">#type=&#39;n&#39;, </span>
    <span class="dt">xlab=</span><span class="st">&#39;X Label&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Y Label&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Main Title&#39;</span>)
<span class="kw">points</span>( <span class="dv">0</span>, <span class="dv">0</span> )            <span class="co"># open circle</span>
<span class="kw">points</span>(.<span class="dv">25</span>, .<span class="dv">25</span>, <span class="dt">pch=</span><span class="dv">19</span>)  <span class="co"># closed black dot</span>
<span class="kw">points</span>(.<span class="dv">50</span>, .<span class="dv">50</span>, <span class="dt">pch=</span><span class="dv">22</span>, <span class="dt">col=</span><span class="st">&#39;red&#39;</span>)  <span class="co"># open red square</span>
<span class="kw">points</span>(<span class="fl">1.0</span>, <span class="fl">1.0</span>, <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">3</span>)       <span class="co"># thick open red circle </span>
<span class="kw">points</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>,.<span class="dv">5</span>,<span class="dv">1</span>), <span class="dt">col=</span><span class="dv">3</span>) <span class="co"># green circles</span></code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
<p>For more details about the different point types, refer to the help page for points().</p>
</div>
<div id="lines" class="section level3">
<h3><span class="header-section-number">5.3.3</span> Lines</h3>
<p>Adding lines to a graph often done by the function <code>abline(intercept, slope)</code> which defines a line. Alternately it supports arguments to draw a horizontal (<code>h=</code>) or vertical line (<code>v=</code>).</p>
<p>Arguments that affect the line characteristics are</p>
<ul>
<li><p><code>col</code> - Color of point. This can be a character string or an integer code. 1-4 correspond to black, red, green, and blue.</p></li>
<li><p><code>lwd</code> - Line width, defaults to 1.</p></li>
<li><p><code>lty</code> - Line type. 1 is a solid line, 2 is dashed, 3 is dotted.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>), <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">type=</span><span class="st">&#39;n&#39;</span>,        <span class="co"># Set up a blank plot...</span>
    <span class="dt">xlab=</span><span class="st">&#39;X Label&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Y Label&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Main Title&#39;</span>)
<span class="kw">abline</span>(<span class="dv">1</span>, -<span class="dv">1</span>/<span class="dv">2</span>)                   <span class="co"># Black line y-intercept=1, slope=-1/2</span>
<span class="kw">abline</span>(<span class="dt">v=</span><span class="dv">1</span>, <span class="dt">col=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">3</span>)         <span class="co"># Vertical solid red line</span>
<span class="kw">abline</span>(<span class="dt">h=</span>.<span class="dv">5</span>, <span class="dt">col=</span><span class="dv">3</span>, <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">5</span>) <span class="co"># Horizonal green dashed line</span></code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p>The way that <code>abline()</code> is defined, it is very convenient to add the least-squares regression line to a plot of data points.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dt">length.out=</span><span class="dv">30</span>)
y &lt;-<span class="st"> </span><span class="dv">3</span> +<span class="st"> </span><span class="dv">2</span>*x +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">30</span>)
<span class="kw">plot</span>(x,y)
<span class="kw">abline</span>( <span class="kw">coef</span>(<span class="kw">lm</span>(y~x)) )    <span class="co"># add the regression line to the plot</span></code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
<p>The second way to add a line to a plot is using the <code>lines()</code> function which allows you to draw an arbitrary curve. It requires vectors of <code>x</code> and <code>y</code> values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="ot">NA</span>, <span class="ot">NA</span>, <span class="dt">xlim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">7</span>), <span class="dt">ylim=</span><span class="kw">c</span>(-<span class="dv">1</span>,<span class="dv">1</span>), <span class="dt">type=</span><span class="st">&#39;n&#39;</span>,   <span class="co"># again a blank plot</span>
    <span class="dt">xlab=</span><span class="st">&#39;X&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;Y&#39;</span>, <span class="dt">main=</span><span class="st">&#39;sin(x)&#39;</span>)
x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">7</span>, <span class="dt">length=</span><span class="dv">201</span>)                           <span class="co"># 201 values from 0 to 7</span>
<span class="kw">lines</span>(x, <span class="kw">sin</span>(x))                                    <span class="co"># sin(x)</span>
<span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>)                                         <span class="co"># Horizontal line at 0</span></code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
</div>
<div id="contour-plots" class="section level3">
<h3><span class="header-section-number">5.3.4</span> Contour Plots</h3>
<p>R can make more advanced plots. One common three dimensional plot is a contour plot, basically a topographical map. To produce this map, we need vectors of <code>x</code> and <code>y</code> coordinates, and a matrix of <code>z</code> values (the elevations in a topo map).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">seq</span>( <span class="dv">0</span>, <span class="dv">10</span>, <span class="dt">length=</span><span class="dv">101</span>)
y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dt">length=</span><span class="dv">101</span>)
z &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">ncol=</span><span class="dv">101</span>, <span class="dt">nrow=</span><span class="dv">101</span>)
for(i in <span class="dv">1</span>:<span class="dv">101</span>){
    for(j in <span class="dv">1</span>:<span class="dv">101</span>){
        z[i,j] &lt;-<span class="st"> </span>x[i] *<span class="st"> </span>y[j]^<span class="dv">2</span>
    }
}
<span class="kw">contour</span>(x,y,z, <span class="dt">xlab=</span><span class="st">&#39;x&#39;</span>, <span class="dt">ylab=</span><span class="st">&#39;y&#39;</span>, <span class="dt">main=</span><span class="st">&#39;Example Contour Plot&#39;</span>)</code></pre></div>
<p><img src="A_Sufficient_Introduction_to_R_files/figure-html/unnamed-chunk-77-1.png" width="672" /></p>
</div>
</div>
<div id="exercises-4" class="section level2">
<h2><span class="header-section-number">5.4</span> Exercises</h2>
<p>For this set of exercises, we’ll use a dataset that contains information about the birthweight of infants and how it relates to the mother’s characteristics. First we’ll load the package the data lives in and update two factor variables to have more intelligent labels.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MASS)
<span class="kw">library</span>(dplyr)
birthwt &lt;-<span class="st"> </span>birthwt %&gt;%<span class="st"> </span><span class="kw">mutate</span>(
  <span class="dt">race  =</span> <span class="kw">factor</span>(race,  <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&#39;White&#39;</span>,<span class="st">&#39;Black&#39;</span>,<span class="st">&#39;Other&#39;</span>)),
  <span class="dt">smoke =</span> <span class="kw">factor</span>(smoke, <span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&#39;No Smoke&#39;</span>, <span class="st">&#39;Smoke&#39;</span>)))</code></pre></div>
<ol style="list-style-type: decimal">
<li><p>Create a histogram of the birthweights (The column is <code>bwt</code>).</p></li>
<li><p>Make a set of boxplots of <code>bwt</code> relative to the mothers <code>race</code>.</p></li>
<li><p>Modify the boxplot command so that the we include both <code>race</code> and <code>smoke</code> by using the formula <code>bwt~race+smoke</code>.</p></li>
<li>Create a scatterplot of the baby’s <code>bwt</code> relative to the mother’s weight <code>lwt</code>.
<ol style="list-style-type: lower-alpha">
<li>First create the simple scatterplot using the <code>plot</code> command. You could using either of the following commands to do this.</li>
</ol>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( birthwt$lwt, birthwt$bwt )
<span class="kw">plot</span>( bwt ~<span class="st"> </span>lwt, <span class="dt">data=</span>birthwt)</code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Add the mothers race by adding <code>col=birthwt$race</code> or <code>col=race</code> argument to the plot command.</p></li>
<li><p>Similarly add the mothers smoking status to the plot by using the character type argument <code>pch=</code>. Unfortunately, we cannot just say <code>pch=smoke</code> because the factor has two levels (coded as 1 and 2), but we need to use point types that are 19 or above. So I want these to be point type 21 (a filled circle) and point type 22 (a filled square). So annoyingly I need to add 20 to the integer value of the <code>smoke</code> variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>( bwt ~<span class="st"> </span>lwt, <span class="dt">data=</span>birthwt,
      <span class="dt">col=</span>race,
      <span class="dt">pch=</span><span class="kw">as.integer</span>(smoke)+<span class="dv">20</span>)</code></pre></div></li>
</ol></li>
</ol>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="4-data-types.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="6-matrices-data-frames-and-lists.html" class="navigation navigation-next " aria-label="Next page""><i class="fa fa-angle-right"></i></a>

<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/dereksonderegger/STA_570L_Book/raw/master/05_BasicGraphing.Rmd",
"text": null
},
"download": null,
"toc": {
"collapse": "section",
"scroll_highlight": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
